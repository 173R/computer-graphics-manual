<main class="material">
  <h1>
    Удаление невидимых поверхностей - Z-Буфер
  </h1>
  <nz-row nzGutter="10">
    <nz-col nzSpan="24">
      <p>
        Z-буферизация — в компьютерной трёхмерной графике способ учёта удалённости элемента изображения. Представляет собой один из вариантов решения «проблемы видимости». Очень эффективен и практически не имеет недостатков, если реализуется аппаратно. Программно же существуют другие методы, способные конкурировать с ним: Z-сортировка («алгоритм художника») и двоичное разбиение пространства (BSP), но они также имеют свои достоинства и недостатки. Основной недостаток Z-буферизации состоит в потреблении большого объёма памяти: в работе используется так называемый буфер глубины или Z-буфер.
      </p>
      <div class="img-wrapper">
        <img src="/assets/img/zbuffer_1.png" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 3.1 - Карта глубины
          </nz-col>
        </nz-row>
      </div>
      <p>
        Z-буфер представляет собой двумерный массив, каждый элемент которого соответствует пикселю на экране. Когда видеокарта рисует пиксель, его удалённость просчитывается и записывается в ячейку Z-буфера. Если пиксели двух рисуемых объектов перекрываются, то их значения глубины сравниваются, и рисуется тот, который ближе, а его значение удалённости сохраняется в буфер. Получаемое при этом графическое изображение носит название z-depth карта или карта глубины, представляющая собой полутоновое графическое изображение, каждый пиксель которого может принимать до 256 значений серого. По ним определяется удалённость от зрителя того или иного объекта трехмерной сцены. Карта широко применяется в постобработке для придания объёмности и реалистичности и создаёт такие эффекты, как глубина резкости, атмосферная дымка и т. д. Также карта используется в 3д-пакетах для текстурирования, делая поверхность рельефной.
      </p>
      <p>
        Разрядность буфера глубины оказывает сильное влияние на качество визуализации: использование 16-битного буфера может привести к геометрическим искажениям, например, эффекту «борьбы», если два объекта находятся близко друг к другу. 24, 32-разрядные буферы хорошо справляются со своей задачей. 8-битные почти никогда не используются из-за низкой точности.
      </p>
      <h2>
        Разбор алгоритма
      </h2>
      <p>
        Давайте представим себе простейшую сцену из трёх треугольников, камера смотрит сверху вниз, мы проецируем наши треугольники на белый экран:
      </p>
      <div class="img-wrapper">
        <img src="/assets/img/zbuffer_2.png" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 3.2 - Пример сцены
          </nz-col>
        </nz-row>
      </div>
      <div class="img-wrapper">
        <img src="/assets/img/zbuffer_3.png" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 3.3 - Рендер сцены
          </nz-col>
        </nz-row>
      </div>
      <!--<div class="img-wrapper">
        <img src="/assets/img/line_1.png" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 1.1 - Проволочный рендер
          </nz-col>
        </nz-row>
      </div>
      <p>Для создания линии с помощью точек (пикселей) используется алгоритм Брезенхема - это алгоритм, определяющий, какие точки двумерного растра нужно закрасить, чтобы получить близкое приближение прямой линии между двумя заданными точками. Это один из старейших алгоритмов в машинной графике — он был разработан Джеком Элтоном Брезенхэмом (англ. Jack Elton Bresenham) в компании IBM в 1962 году. Алгоритм широко используется, в частности, для рисования линий на экране компьютера.</p>
      <div class="img-wrapper">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/LineBresenham.gif/336px-LineBresenham.gif" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 1.2 - Демонстрация работы алгоритма
          </nz-col>
        </nz-row>
      </div>
      <h2>
        Описание алгоритма
      </h2>
      <p>
        Отрезок проводится между двумя точками - (x0, y0) и (x1, y1), где в этих парах указаны столбец и строка соответственно, номера которых растут вправо и вниз. Сначала мы будем предполагать, что наша линия идёт вправо и вниз, причём горизонтальное расстояние x1 - x0 превосходит вертикальное y1 - y0, то есть наклон линии от горизонтали — менее 45°. Наша цель состоит в том, чтобы для каждого столбца x между x0 и x1 определить, какая строка y ближе всего к линии, и нарисовать точку (x, y).
      </p>
      <div class="img-wrapper">
        <img src="assets/img/line_3.svg" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 1.3 - Общая формула линии между двумя точками
          </nz-col>
        </nz-row>
      </div>
      <h2>
        Проволочный рендер
      </h2>
      <p>Теперь с помощью алгоритма создания линий мы готовы создать проволочный рендер. Для хранения 3D модели рекомендуется использовать формат .obj из-за его простоты, файл данного формат содержит координаты вершин (X, Y, Z), по одной координате на каждую строку.</p>
      <h2>Задание</h2>
      <h3>1. Реализовать алгоритм построения линии</h3>
      <h4>Начальный код:</h4>
      <pre><code [languages]="['c++']" [highlight]="code1"></code></pre>
      <h3 [style.padding-top.px]="15">2. Создать рендер трёх линий различного цвета с различными углами наклона, как показанно на примере.</h3>
      <div class="img-wrapper">
        <img src="assets/img/line_4.jpg" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 1.4 - Пример выполненного задания - 2
          </nz-col>
        </nz-row>
      </div>
      <h3>3. Создать проволочный рендер 3D объекта с помощью функции рисования линии</h3>
      <div class="img-wrapper">
        <img src="https://ylianova.ru/800/600/https/wsd.events/2015/06/20/pres/webgl/pictures/top_wireframe.jpg" alt="">
        <nz-row nzJustify="center">
          <nz-col>
            Рисунок 1.5 - Пример выполненного задания - 3
          </nz-col>
        </nz-row>
      </div>
      <h4>Начальный код:</h4>
      <pre><code [languages]="['c++']" [highlight]="code1"></code></pre>-->
    </nz-col>
    <nz-col nzSpan="24">
      <div>
      </div>
      <!--<div class="img-wrapper">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/LineBresenham.gif/336px-LineBresenham.gif" alt="">
      </div>-->
    </nz-col>
  </nz-row>
</main>
